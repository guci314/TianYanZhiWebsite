<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>移动端PDF测试</title>
    <style>
        /* 引入我们的CSS样式 */
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        
        /* 复制我们的CSS样式 */
        .dcmp-watermark {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            opacity: 0.15;
            font-size: 2rem;
            color: #888;
            text-align: center;
            z-index: 9999;
            user-select: none;
            white-space: pre-wrap;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .dcmp-media-container {
            position: relative;
            display: block;
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
        }
        
        .dcmp-pdf-container {
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        @media screen and (max-width: 768px) {
            .dcmp-watermark {
                font-size: 1.2rem;
                opacity: 0.1;
            }
            
            .dcmp-media-container {
                margin: 10px 0;
            }
            
            .dcmp-pdf-container iframe {
                min-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📱 移动端PDF测试页面</h1>
        
        <div id="device-info" style="background: #e7f3ff; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
            <strong>设备信息:</strong> <span id="device-details">检测中...</span>
        </div>
        
        <h2>测试1: 简单的PDF显示</h2>
        <div id="pdf-test-1">
            <!-- 这里会动态插入PDF查看器 -->
        </div>
        
        <h2>测试2: 外部PDF链接</h2>
        <div style="border: 1px solid #ccc; padding: 20px; text-align: center;">
            <p>由于安全限制，此测试需要真实的PDF文件</p>
            <a href="https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" target="_blank">
                📄 打开测试PDF (外部链接)
            </a>
        </div>
        
        <h2>调试信息</h2>
        <div id="debug-info" style="background: #f0f0f0; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 12px;">
            <!-- 调试信息将在这里显示 -->
        </div>
    </div>
    
    <script>
        // 设备检测功能 (从我们的代码中复制)
        function detectDevice() {
            const userAgent = navigator.userAgent;
            const isMobile = /Mobi|Android/i.test(userAgent);
            const isIOS = /iPhone|iPad|iPod/i.test(userAgent);
            const isAndroid = /Android/i.test(userAgent);
            const isSafari = /Safari/.test(userAgent) && !/Chrome/.test(userAgent);
            const isChrome = /Chrome/.test(userAgent);
            const isFirefox = /Firefox/.test(userAgent);
            
            return {
                isMobile,
                isIOS, 
                isAndroid,
                isSafari,
                isChrome,
                isFirefox,
                userAgent,
                screenWidth: window.screen.width,
                screenHeight: window.screen.height,
                viewportWidth: window.innerWidth,
                viewportHeight: window.innerHeight
            };
        }
        
        // 生成移动端PDF查看器 (简化版)
        function generateMobilePdfViewer() {
            const device = detectDevice();
            const testPdfUrl = 'data:application/pdf;base64,JVBERi0xLjMKJcTl8uXrp/Og0MTGCjQgMCBvYmoKPDwKL0xlbmd0aCA5NTIKL0ZpbHRlciAvRmxhdGVEZWNvZGUKPj4Kc3RyZWFtCnicY2BgYGAYxYABAAoAAQplbmRzdHJlYW0KZW5kb2JqCjEgMCBvYmoKPDwKL1R5cGUgL0NhdGFsb2cKL091dGxpbmVzIDIgMCBSCi9QYWdlcyAzIDAgUgo+PgplbmRvYmoKMiAwIG9iago8PAovVHlwZSAvT3V0bGluZXMKL0NvdW50IDAKPD4KZW5kb2JqCjMgMCBvYmoKPDwKL1R5cGUgL1BhZ2VzCi9Db3VudCAxCi9LaWRzIFs0IDAgUl0KPj4KZW5kb2JqCjQgMCBvYmoKPDwKL1R5cGUgL1BhZ2UKL1BhcmVudCAzIDAgUgovUmVzb3VyY2VzIDw8Ci9Gb250IDw8Ci9GMSAiIDAgUgo+Pgo+PgovTWVkaWFCb3ggWzAgMCA2MTIgNzkyXQovQ29udGVudHMgNSAwIFIKPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDEyIFRmCjcyIDcyMCBUZAooVGVzdCBQREYpIFRqCkVUCmVuZHN0cmVhbQplbmRvYmoKNiAwIG9iago8PAovVHlwZSAvRm9udAovU3VidHlwZSAvVHlwZTEKL0Jhc2VGb250IC9IZWx2ZXRpY2EKPj4KZW5kb2JqCnhyZWYKMCA3CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDA2MyAwMDAwMCBuIAowMDAwMDAwMTI0IDAwMDAwIG4gCjAwMDAwMDAxODEgMDAwMDAgbiAKMDAwMDAwMDIzOCAwMDAwMCBuIAowMDAwMDAwMzk0IDAwMDAwIG4gCjAwMDAwMDA0ODggMDAwMDAgbiAKdHJhaWxlcgo8PAovU2l6ZSA3Ci9Sb290IDEgMCBSCj4+CnN0YXJ0eHJlZgo1ODUKJSVFT0Y=';
            
            let html = '';
            
            if (device.isMobile) {
                if (device.isIOS && device.isSafari) {
                    // iOS Safari
                    html = `
                    <div class="dcmp-pdf-ios-container" style="width:100%; height:400px; border:1px solid #ccc; background:#f9f9f9; display:flex; flex-direction:column; border-radius:8px; overflow:hidden;">
                        <div style="background:#007cba; color:white; padding:12px; text-align:center; font-size:16px;">
                            📄 iOS PDF查看器
                        </div>
                        <div style="flex:1; position:relative; background:white;">
                            <iframe src="${testPdfUrl}" style="width:100%; height:100%; border:none;"></iframe>
                        </div>
                        <div style="background:#f0f0f0; padding:10px; text-align:center; border-top:1px solid #ddd;">
                            <a href="${testPdfUrl}" target="_blank" style="background:#007cba; color:white; padding:8px 16px; text-decoration:none; border-radius:4px; font-size:14px;">
                                在新标签页打开
                            </a>
                        </div>
                    </div>`;
                } else if (device.isAndroid) {
                    // Android
                    html = `
                    <div class="dcmp-pdf-android-container" style="width:100%; height:400px; border:1px solid #ccc; background:#f9f9f9; position:relative; border-radius:8px; overflow:hidden;">
                        <div style="position:absolute; top:10px; right:10px; z-index:1000;">
                            <a href="${testPdfUrl}" target="_blank" style="background:#007cba; color:white; padding:6px 12px; text-decoration:none; border-radius:4px; font-size:12px; box-shadow:0 2px 4px rgba(0,0,0,0.2);">
                                新窗口
                            </a>
                        </div>
                        <div style="padding:20px; text-align:center; height:100%; display:flex; flex-direction:column; justify-content:center;">
                            <div style="font-size:48px; margin-bottom:20px;">📄</div>
                            <h3>Android PDF查看器</h3>
                            <p>正在加载PDF.js...</p>
                            <div style="margin-top:20px;">
                                <a href="${testPdfUrl}" target="_blank" style="background:#28a745; color:white; padding:10px 20px; text-decoration:none; border-radius:4px;">
                                    下载查看
                                </a>
                            </div>
                        </div>
                    </div>`;
                } else {
                    // 其他移动设备
                    html = `
                    <div class="dcmp-pdf-generic-container" style="width:100%; height:400px; border:1px solid #ccc; background:#f9f9f9; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px; box-sizing:border-box; border-radius:8px;">
                        <div style="font-size:48px; margin-bottom:20px; color:#666;">📄</div>
                        <h3 style="margin:0 0 15px 0; color:#333;">通用移动端PDF查看器</h3>
                        <p style="margin:0 0 20px 0; color:#666; line-height:1.4;">
                            移动设备上查看PDF可能受到限制<br>
                            建议使用以下方式打开文档
                        </p>
                        <div style="display:flex; flex-direction:column; gap:10px; width:100%; max-width:250px;">
                            <a href="${testPdfUrl}" target="_blank" style="background:#007cba; color:white; padding:12px 20px; text-decoration:none; border-radius:5px; font-size:16px; display:block;">
                                🔗 在新窗口打开
                            </a>
                            <a href="${testPdfUrl}" download style="background:#28a745; color:white; padding:12px 20px; text-decoration:none; border-radius:5px; font-size:16px; display:block;">
                                📥 下载查看
                            </a>
                        </div>
                        <small style="margin-top:15px; color:#999; font-size:12px;">
                            某些设备可能需要安装PDF阅读器应用
                        </small>
                    </div>`;
                }
            } else {
                // 桌面端
                html = `
                <div style="width:100%; height:400px; border:1px solid #ccc; border-radius:5px; overflow:hidden;">
                    <iframe src="${testPdfUrl}" style="width:100%; height:100%; border:none;"></iframe>
                </div>`;
            }
            
            // 添加水印
            html = `
            <div class="dcmp-media-container dcmp-pdf-container" style="position:relative; max-width:100%; overflow:hidden;">
                ${html}
                <div class="dcmp-watermark">数字中国</div>
            </div>`;
            
            return html;
        }
        
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            const device = detectDevice();
            
            // 显示设备信息
            document.getElementById('device-details').innerHTML = `
                ${device.isMobile ? '移动设备' : '桌面设备'} | 
                ${device.isIOS ? 'iOS' : device.isAndroid ? 'Android' : '其他'} | 
                ${device.isSafari ? 'Safari' : device.isChrome ? 'Chrome' : device.isFirefox ? 'Firefox' : '其他浏览器'} |
                ${device.viewportWidth}x${device.viewportHeight}
            `;
            
            // 生成PDF查看器
            document.getElementById('pdf-test-1').innerHTML = generateMobilePdfViewer();
            
            // 显示调试信息
            document.getElementById('debug-info').innerHTML = `
检测到的设备类型: ${JSON.stringify(device, null, 2)}

期望行为:
- iOS Safari: 显示原生PDF查看器界面
- Android: 显示PDF.js加载界面  
- 桌面端: 显示传统iframe
- 其他移动设备: 显示通用PDF查看器

实际显示: 请检查上方PDF测试区域的内容
            `;
        });
    </script>
</body>
</html> 