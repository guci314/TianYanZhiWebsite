<!DOCTYPE html>
<html>
<head>
    <title>全屏功能测试</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>全屏功能调试测试</h1>
    
    <div style="margin: 20px 0;">
        <button onclick="testFullscreen()" style="background: #007cba; color: white; border: none; padding: 15px 25px; border-radius: 5px; cursor: pointer; font-size: 16px;">
            🔳 测试全屏功能
        </button>
        
        <button onclick="testConsole()" style="background: #28a745; color: white; border: none; padding: 15px 25px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-left: 10px;">
            🐛 测试控制台
        </button>
    </div>
    
    <div id="pdf-container" style="border: 2px solid #007cba; border-radius: 8px; overflow: hidden; background: #f9f9f9; width: 800px; height: 600px; position: relative;">
        <iframe id="test-iframe" 
                src="/wp-content/plugins/pdfjs-viewer-shortcode/pdfjs/web/viewer.php?file=/wp-content/uploads/2025/05/How-To-Use-AI-Agents-in-2025.pdf" 
                width="100%" 
                height="100%" 
                style="border: none; display: block;"
                title="PDF测试查看器">
        </iframe>
    </div>
    
    <div id="debug-info" style="background: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; margin-top: 20px; font-family: monospace; font-size: 12px;">
        <strong>调试信息将显示在这里...</strong>
    </div>
    
    <script>
    function updateDebug(message) {
        const debugDiv = document.getElementById('debug-info');
        const timestamp = new Date().toLocaleTimeString();
        debugDiv.innerHTML += '<br>[' + timestamp + '] ' + message;
        console.log('[' + timestamp + '] ' + message);
    }
    
    function testConsole() {
        updateDebug('🐛 测试控制台功能正常工作');
        alert('控制台测试成功！请检查F12开发者工具中的Console标签页');
    }
    
    function testFullscreen() {
        updateDebug('🚀 开始全屏测试...');
        
        const container = document.getElementById('pdf-container');
        const iframe = document.getElementById('test-iframe');
        
        if (!container) {
            updateDebug('❌ 找不到PDF容器');
            return;
        }
        
        if (!iframe) {
            updateDebug('❌ 找不到PDF iframe');
            return;
        }
        
        updateDebug('✅ 找到容器和iframe');
        updateDebug('🔍 iframe src: ' + iframe.src);
        
        // 检查浏览器支持
        if (iframe.requestFullscreen) {
            updateDebug('✅ 浏览器支持 requestFullscreen');
            iframe.requestFullscreen().then(() => {
                updateDebug('✅ HTML5全屏成功！');
                alert('✅ 全屏成功！按ESC退出全屏');
            }).catch(err => {
                updateDebug('❌ 全屏失败: ' + err.message);
                alert('❌ 全屏失败: ' + err.message + '\n\n尝试新窗口打开...');
                window.open(iframe.src, '_blank', 'width=' + screen.width + ',height=' + screen.height);
            });
        } else if (iframe.webkitRequestFullscreen) {
            updateDebug('✅ 浏览器支持 webkitRequestFullscreen (Safari/Chrome)');
            iframe.webkitRequestFullscreen();
        } else if (iframe.mozRequestFullScreen) {
            updateDebug('✅ 浏览器支持 mozRequestFullScreen (Firefox)');
            iframe.mozRequestFullScreen();
        } else {
            updateDebug('❌ 浏览器不支持全屏API');
            alert('❌ 浏览器不支持全屏API，将打开新窗口');
            window.open(iframe.src, '_blank', 'width=' + screen.width + ',height=' + screen.height);
        }
    }
    
    // 监听全屏变化事件
    document.addEventListener('fullscreenchange', function() {
        if (document.fullscreenElement) {
            updateDebug('📱 进入全屏模式');
        } else {
            updateDebug('🔙 退出全屏模式');
        }
    });
    
    document.addEventListener('webkitfullscreenchange', function() {
        if (document.webkitFullscreenElement) {
            updateDebug('📱 进入全屏模式 (webkit)');
        } else {
            updateDebug('🔙 退出全屏模式 (webkit)');
        }
    });
    
    // 页面加载完成时的初始化
    document.addEventListener('DOMContentLoaded', function() {
        updateDebug('🏁 页面加载完成');
        updateDebug('🌐 用户代理: ' + navigator.userAgent);
        updateDebug('📱 是否移动设备: ' + /Mobi|Android/i.test(navigator.userAgent));
        
        // 检查iframe是否加载成功
        const iframe = document.getElementById('test-iframe');
        iframe.onload = function() {
            updateDebug('✅ PDF iframe加载成功');
        };
        iframe.onerror = function() {
            updateDebug('❌ PDF iframe加载失败');
        };
    });
    </script>
</body>
</html>